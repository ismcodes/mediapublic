!function(){function e(e,t){m.style.backgroundColor=e,d.textContent=t,m.style.display="block",setTimeout(function(){m.style.display="none"},2e3)}function t(){return window.location.href.match(/recordings\/:(\d+)/)[1]}function n(){var e;return"www.npr.org"==c&&(e={title:document.getElementsByClassName("storytitle")[0].children[0].innerHTML,organization_id:123,recorded_datetime:document.getElementsByTagName("time")[1].getAttribute("datetime")}),e}function i(){return"www.npr.org"==c?encodeURI(document.getElementsByClassName("download")[0].href.replace("?dl=1","")):c==r?"pending":void 0}function o(){if(console.log("hi"),l)return!1;var e,n=new XMLHttpRequest;e=c==r?"http://"+r+"/playlists/"+p+"?recording_id="+t():"http://"+r+"/playlists/"+p+"?url="+u,n.open("POST",e,!0),n.onreadystatechange=s,n.send(),l=!0}function s(t){if(4==this.readyState)if(l=!1,200==this.status)if("success"==this.responseText)e("#27ae60","Successfully added!");else{e("#ec5e00","Adding recording to database..");var i=new XMLHttpRequest,o=n(),s="title="+o.title+"&organization_id="+o.organization_id+"&recorded_datetime="+o.recorded_datetime;i.open("POST","http://"+r+"/recordings?"+s,!0),i.onreadystatechange=a,i.send(),l=!0}else e("#e74c3c","Error "+this.status)}function a(t){4==this.readyState&&(l=!1,200==this.status?o():e("#e74c3c","Error "+this.status))}var d,r="localhost:4567",l=!1,c=document.location.host,u=i(),p=prompt("playlist id?"),m=document.getElementsByClassName("mediapublic-display-area")[0];void 0===m?(m=document.createElement("div"),m.classList.add("mediapublic-display-area"),m.style.top="10px",m.style.right="10px",m.style.position="absolute",m.style.color="#ecf0f1",m.style.zIndex=999,d=document.createTextNode(""),m.appendChild(d),document.body.appendChild(m)):d=m.childNodes[0],o()}();
